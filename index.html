<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ¤ç‰©åˆ†é¡ã‚²ãƒ¼ãƒ </title>
  <style>
    body { background-color: black; color: white; text-align: center; font-family: 'Courier New', monospace; }
    #gameContainer { display: inline-block; border: 2px solid white; padding: 10px; width: 300px; background-color: black; }
    #messageBox { border: 2px solid white; padding: 5px; margin-bottom: 10px; font-size: 1.2em; }
    #plantImage {
      width: 200px; height: 200px;
      object-fit: contain;
      display: block;
      margin: 10px auto;
      border: 2px solid white;
    }
    #categoryButtons { display: flex; flex-wrap: wrap; justify-content: center; }
    .category-button {
      margin: 5px; padding: 5px; font-size: 1em;
      cursor: pointer; background-color: black;
      color: white; border: 1px solid white; width: 100px;
    }
    .category-button:hover { background-color: white; color: black; }
    .hp-bar-container {
      width: 100%; height: 20px; background-color: gray; margin: 5px 0;
    }
    .hp-bar {
      height: 100%; background-color: red; width: 100%;
      transition: width 0.3s;
    }
    #timer, #score { font-size: 1.5em; margin-top: 10px; }
  </style>
</head>
<body>

<div id="gameContainer">
  <div id="messageBox">æ¤ç‰©ãŒ ã‚ã‚‰ã‚ã‚ŒãŸï¼</div>
  <div>ğŸŒ¿æ¤ç‰©ã®HP</div>
  <div class="hp-bar-container"><div id="enemyHPBar" class="hp-bar"></div></div>
  <img id="plantImage" src="" alt="æ¤ç‰©ã®ç”»åƒ">
  <div>ğŸ§‘ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®HP</div>
  <div class="hp-bar-container"><div id="playerHPBar" class="hp-bar"></div></div>
  <div id="categoryButtons">
    <button class="category-button" data-category="ã‚­ã‚¯">ã‚­ã‚¯</button>
    <button class="category-button" data-category="ã‚¢ãƒ–ãƒ©ãƒŠ">ã‚¢ãƒ–ãƒ©ãƒŠ</button>
    <button class="category-button" data-category="ã‚¤ãƒ">ã‚¤ãƒ</button>
    <button class="category-button" data-category="ãƒãƒ¡">ãƒãƒ¡</button>
    <button class="category-button" data-category="ã‚¦ãƒª">ã‚¦ãƒª</button>
    <button class="category-button" data-category="ãã®ä»–">ãã®ä»–</button>
  </div>
</div>

<script>
const IMAGE_FOLDER = "https://kogkoba.github.io/science2/";

// BGMã‚ªãƒ¼ãƒ‡ã‚£ã‚ªè¨­å®š
const bgmStart = new Audio(IMAGE_FOLDER + "ãƒˆã‚™ãƒ©ã‚¯ã‚¨é¢¨å§‹ã¾ã‚Š.mp3");
const bgmLoop = new Audio(IMAGE_FOLDER + "ãƒˆã‚™ãƒ©ã‚¯ã‚¨é¢¨ç¹°ã‚Šè¿”ã—.mp3");
bgmLoop.loop = true;

// æ¤ç‰©ç”»åƒãƒªã‚¹ãƒˆ
const allPlantImages = [
  "ã‚¢ãƒ–ãƒ©ãƒŠ-ã‚¢ãƒ–ãƒ©ãƒŠ.png", "ã‚¢ãƒ–ãƒ©ãƒŠ-ã‚¤ãƒŒã‚¬ãƒ©ã‚·.png", "ã‚¢ãƒ–ãƒ©ãƒŠ-ã‚«ãƒ–.png", "ã‚¢ãƒ–ãƒ©ãƒŠ-ã‚­ãƒ£ãƒ™ãƒ„.png",
  "ã‚¢ãƒ–ãƒ©ãƒŠ-ãƒ€ã‚¤ã‚³ãƒ³.png", "ã‚¢ãƒ–ãƒ©ãƒŠ-ãƒŠã‚ºãƒŠ.png", "ã‚¢ãƒ–ãƒ©ãƒŠ-ãƒ¯ã‚µãƒ“.png",
  "ã‚¤ãƒ-ã‚¤ãƒ.png", "ã‚¤ãƒ-ã‚¨ãƒã‚³ãƒ­ã‚°ã‚µ.png", "ã‚¤ãƒ-ã‚ªãƒ’ã‚·ãƒ.png", "ã‚¤ãƒ-ã‚³ãƒ ã‚®.png",
  "ã‚¤ãƒ-ã‚µã‚µ.png", "ã‚¤ãƒ-ã‚¹ã‚¹ã‚­.png", "ã‚¤ãƒ-ã‚¹ã‚ºãƒ¡ãƒã‚«ã‚¿ãƒ“ãƒ©.png", "ã‚¤ãƒ-ã‚¹ã‚ºãƒ¡ãƒãƒ†ãƒƒãƒã‚¦.png",
  "ã‚¤ãƒ-ã‚¿ã‚±.png", "ã‚¤ãƒ-ãƒˆã‚¦ãƒ¢ãƒ­ã‚³ã‚·.png", "ã‚¤ãƒ-ãƒ¡ãƒ’ã‚·ãƒ.png",
  "ã‚¦ãƒª-ã‚¢ãƒãƒãƒ£ãƒ…ãƒ«.png", "ã‚¦ãƒª-ã‚«ãƒœãƒãƒ£.png", "ã‚¦ãƒª-ã‚«ãƒ©ã‚¹ã‚¦ãƒª.png",
  "ã‚¦ãƒª-ã‚­ãƒ¥ã‚¦ãƒª.png", "ã‚¦ãƒª-ã‚¹ã‚¤ã‚«.png", "ã‚¦ãƒª-ãƒ˜ãƒãƒ.png", "ã‚¦ãƒª-ãƒ¦ã‚¦ã‚¬ã‚ª.png"
];

let availableImages = [...allPlantImages];
let playerHP = 50;
let enemyHP = 50;
let correctCategoryMap = {};

// ç”»åƒã”ã¨ã®ã‚«ãƒ†ã‚´ãƒªã‚’è¨­å®š
allPlantImages.forEach(img => {
  correctCategoryMap[img] = img.split("-")[0];
});

// HPãƒãƒ¼æ›´æ–°
function updateHPBars() {
  document.getElementById("playerHPBar").style.width = (playerHP / 50) * 100 + "%";
  document.getElementById("enemyHPBar").style.width = (enemyHP / 50) * 100 + "%";
}

// å‡ºé¡Œå‡¦ç†
function showQuestion() {
  if (availableImages.length === 0) availableImages = [...allPlantImages];
  let randomIndex = Math.floor(Math.random() * availableImages.length);
  let currentImage = availableImages.splice(randomIndex, 1)[0];

  let imgPath = IMAGE_FOLDER + currentImage;
  let plantName = currentImage.split("-")[1].replace(".png", "");

  document.getElementById("plantImage").src = imgPath;
  document.getElementById("messageBox").textContent = `æ¤ç‰©ã¯ã€Œ${plantName}ã€ã‚’ ã¯ãªã£ãŸï¼`;

  document.querySelectorAll(".category-button").forEach(button => {
    button.onclick = () => checkAnswer(button.getAttribute("data-category"), correctCategoryMap[currentImage], plantName);
  });
}

// å›ç­”å‡¦ç†
function checkAnswer(selectedCategory, correctCategory, plantName) {
  if (selectedCategory === correctCategory) {
    enemyHP -= 10;
    document.getElementById("messageBox").textContent = `æ­£è§£ï¼${plantName}ã« 10ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`;
  } else {
    playerHP -= 10;
    let correctText = correctCategory === "ãã®ä»–" ? "ãã®ä»–" : `${correctCategory}ç§‘`;
    document.getElementById("messageBox").textContent = `ãƒŸã‚¹ï¼${plantName}ã¯ ${correctText} ã ï¼ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã« 10ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`;
  }
  updateHPBars();

  if (enemyHP <= 0) {
    endGame("player");
  } else if (playerHP <= 0) {
    endGame("enemy");
  } else {
    setTimeout(showQuestion, 1000);
  }
}

// ã‚²ãƒ¼ãƒ çµ‚äº†
function endGame(winner) {
  bgmStart.pause();
  bgmLoop.pause();
  
  document.getElementById("messageBox").textContent = winner === "player" ? `æ¤ç‰©ã¯ ãŸãŠã•ã‚ŒãŸï¼` : `ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ ãŸãŠã‚Œã¦ã—ã¾ã£ãŸï¼`;
  document.getElementById("plantImage").style.display = "none";
  document.getElementById("categoryButtons").style.display = "none";

  let continueButton = document.createElement("button");
  continueButton.textContent = "ãã¡ã¶ãˆ";
  continueButton.style.marginTop = "10px";
  continueButton.style.padding = "10px";
  continueButton.style.fontSize = "1em";
  continueButton.style.backgroundColor = "black";
  continueButton.style.color = "white";
  continueButton.style.border = "1px solid white";
  continueButton.onclick = () => location.reload();
  
  document.getElementById("gameContainer").appendChild(continueButton);
}

// ã‚²ãƒ¼ãƒ é–‹å§‹
function startGame() {
  bgmStart.play();
  bgmStart.onended = () => bgmLoop.play();
  showQuestion();
  updateHPBars();
}

startGame();
</script>
</body>
</html>
